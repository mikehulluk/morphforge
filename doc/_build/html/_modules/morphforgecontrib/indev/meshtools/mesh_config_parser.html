

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>morphforgecontrib.indev.meshtools.mesh_config_parser &mdash; morphforge</title>
    
    <link rel="stylesheet" href="../../../../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../../_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../../',
        VERSION:     '0.1-alpha',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../../_static/theme_extras.js"></script>
    <link rel="top" title="morphforge" href="../../../../index.html" />
    <link rel="up" title="Module code" href="../../../index.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="../../../../index.html">
          <span>morphforge</span></a></h1>
        <h2 class="heading"><span>morphforgecontrib.indev.meshtools.mesh_config_parser</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>
      <div class="content">
        
        
  <h1>Source code for morphforgecontrib.indev.meshtools.mesh_config_parser</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/python</span>
<span class="c"># -*- coding: utf-8 -*-</span>

<span class="c"># ---------------------------------------------------------------------</span>
<span class="c"># Copyright (c) 2012 Michael Hull.</span>
<span class="c"># All rights reserved.</span>
<span class="c">#</span>
<span class="c"># Redistribution and use in source and binary forms, with or without</span>
<span class="c"># modification, are permitted provided that the following conditions</span>
<span class="c"># are met:</span>
<span class="c">#</span>
<span class="c">#  - Redistributions of source code must retain the above copyright</span>
<span class="c">#    notice, this list of conditions and the following disclaimer.</span>
<span class="c">#  - Redistributions in binary form must reproduce the above copyright</span>
<span class="c">#    notice, this list of conditions and the following disclaimer in</span>
<span class="c">#    the documentation and/or other materials provided with the</span>
<span class="c">#    distribution.</span>
<span class="c">#</span>
<span class="c"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS</span>
<span class="c"># &quot;AS IS&quot; AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT</span>
<span class="c"># LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR</span>
<span class="c"># A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT</span>
<span class="c"># HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,</span>
<span class="c"># SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT</span>
<span class="c"># LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,</span>
<span class="c"># DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY</span>
<span class="c"># THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT</span>
<span class="c"># (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c">#  OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c"># ----------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">ply.lex</span> <span class="kn">as</span> <span class="nn">lex</span>
<span class="kn">from</span> <span class="nn">core</span> <span class="kn">import</span> <span class="n">Context</span><span class="p">,</span> <span class="n">ColorDef</span>
<span class="kn">from</span> <span class="nn">core</span> <span class="kn">import</span> <span class="n">MeshGenerationOptions</span>

<span class="kn">import</span> <span class="nn">ply.yacc</span> <span class="kn">as</span> <span class="nn">yacc</span>

<span class="n">reserved</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">&#39;Default&#39;</span><span class="p">:</span> <span class="s">&#39;DEFAULT_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;MAKEPLY&#39;</span><span class="p">:</span> <span class="s">&#39;MAKEPLY_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;Include&#39;</span><span class="p">:</span> <span class="s">&#39;INCLUDE_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;RegionColor&#39;</span><span class="p">:</span> <span class="s">&#39;REGIONCOLOR_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;IGNORE&#39;</span><span class="p">:</span> <span class="s">&#39;IGNORE_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;COLOR_ALIASES&#39;</span><span class="p">:</span> <span class="s">&#39;COLOR_ALIASES_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;COLOR_DEFAULTS&#39;</span><span class="p">:</span> <span class="s">&#39;COLOR_DEFAULTS_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;TRIM&#39;</span><span class="p">:</span> <span class="s">&#39;TRIM_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;OFFSET&#39;</span><span class="p">:</span> <span class="s">&#39;OFFSET_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;OPTION_DEFAULTS&#39;</span><span class="p">:</span> <span class="s">&#39;OPTION_DEFAULTS_ID&#39;</span><span class="p">,</span>
    <span class="s">&#39;MIN_DIAMETER&#39;</span><span class="p">:</span> <span class="s">&#39;MIN_DIAMETER_ID&#39;</span><span class="p">,</span>
    <span class="p">}</span>

<span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s">&#39;FILENAME&#39;</span><span class="p">,</span>
    <span class="s">&#39;COMMA&#39;</span><span class="p">,</span>
    <span class="s">&#39;FLOAT&#39;</span><span class="p">,</span>
    <span class="s">&#39;INT&#39;</span><span class="p">,</span>
    <span class="s">&#39;COLON&#39;</span><span class="p">,</span>
    <span class="s">&#39;LBRACE&#39;</span><span class="p">,</span>
    <span class="s">&#39;RBRACE&#39;</span><span class="p">,</span>
    <span class="s">&#39;RPAREN&#39;</span><span class="p">,</span>
    <span class="s">&#39;LPAREN&#39;</span><span class="p">,</span>
    <span class="s">&#39;SEMICOLON&#39;</span><span class="p">,</span>
    <span class="s">&#39;STAR&#39;</span><span class="p">,</span>
    <span class="s">&#39;ID&#39;</span><span class="p">,</span>
    <span class="p">]</span> <span class="o">+</span> <span class="nb">list</span><span class="p">(</span><span class="n">reserved</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>


<div class="viewcode-block" id="t_ID"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_ID">[docs]</a><span class="k">def</span> <span class="nf">t_ID</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;[a-zA-Z_][a-zA-Z_0-9]*&#39;&#39;&#39;</span>

    <span class="n">t</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">reserved</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s">&#39;ID&#39;</span><span class="p">)</span>  <span class="c"># Check for reserved words</span>
    <span class="k">return</span> <span class="n">t</span>


</div>
<div class="viewcode-block" id="t_FLOAT"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_FLOAT">[docs]</a><span class="k">def</span> <span class="nf">t_FLOAT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;[-+]?[0-9]*\.[0-9]+([eE][-+]?[0-9]+)?&quot;&quot;&quot;</span>

    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

</div>
<div class="viewcode-block" id="t_INT"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_INT">[docs]</a><span class="k">def</span> <span class="nf">t_INT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;\d+&#39;&#39;&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">t</span>

</div>
<div class="viewcode-block" id="t_FILENAME"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_FILENAME">[docs]</a><span class="k">def</span> <span class="nf">t_FILENAME</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;&quot;.*&quot;&#39;&#39;&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">t</span>

</div>
<div class="viewcode-block" id="t_COMMENT"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_COMMENT">[docs]</a><span class="k">def</span> <span class="nf">t_COMMENT</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;\#.*&#39;&#39;&#39;</span>
    <span class="k">pass</span>

</div>
<span class="n">t_COMMA</span> <span class="o">=</span> <span class="s">r&#39;,&#39;</span>
<span class="n">t_SEMICOLON</span> <span class="o">=</span> <span class="s">r&#39;;&#39;</span>
<span class="n">t_COLON</span> <span class="o">=</span> <span class="s">r&#39;:&#39;</span>

<span class="n">t_STAR</span> <span class="o">=</span> <span class="s">r&#39;\*&#39;</span>
<span class="n">t_LPAREN</span> <span class="o">=</span> <span class="s">r&#39;\(&#39;</span>
<span class="n">t_RPAREN</span> <span class="o">=</span> <span class="s">r&#39;\)&#39;</span>
<span class="n">t_LBRACE</span> <span class="o">=</span> <span class="s">r&#39;\{&#39;</span>
<span class="n">t_RBRACE</span> <span class="o">=</span> <span class="s">r&#39;\}&#39;</span>


<span class="c"># Define a rule so we can track line numbers</span>
<div class="viewcode-block" id="t_newline"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_newline">[docs]</a><span class="k">def</span> <span class="nf">t_newline</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="sd">r&#39;&#39;&#39;\n+&#39;&#39;&#39;</span>
    <span class="n">t</span><span class="o">.</span><span class="n">lexer</span><span class="o">.</span><span class="n">lineno</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>


<span class="c"># A string containing ignored characters (spaces and tabs)</span></div>
<span class="n">t_ignore</span> <span class="o">=</span> <span class="s">&#39; </span><span class="se">\t</span><span class="s">&#39;</span>

<span class="kn">from</span> <span class="nn">errors</span> <span class="kn">import</span> <span class="n">MultiMeshParseError</span>


<span class="c"># Error handling rule</span>

<div class="viewcode-block" id="t_error"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.t_error">[docs]</a><span class="k">def</span> <span class="nf">t_error</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Illegal character &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">raise</span> <span class="n">MultiMeshParseError</span><span class="p">(</span><span class="s">&quot;Lexer couldn&#39;t parse: &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span> <span class="o">%</span> <span class="n">t</span><span class="o">.</span><span class="n">value</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>


<span class="c"># Build the lexer</span></div>
<span class="n">lexer</span> <span class="o">=</span> <span class="n">lex</span><span class="o">.</span><span class="n">lex</span><span class="p">()</span>



<span class="c"># Overall File:</span>

<div class="viewcode-block" id="p_config_completeB"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_config_completeB">[docs]</a><span class="k">def</span> <span class="nf">p_config_completeB</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;config :  config config_block</span>
<span class="sd">               |  config_block&quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>


<span class="c">## Blocks</span>
<span class="c">## -------------</span></div>
<div class="viewcode-block" id="p_configblocksA"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_configblocksA">[docs]</a><span class="k">def</span> <span class="nf">p_configblocksA</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;config_block : color_defaults_block</span>
<span class="sd">                    | color_aliases_block</span>
<span class="sd">                    | options_block</span>
<span class="sd">                    | makeply_block &quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>




<span class="c">#Options:</span></div>
<div class="viewcode-block" id="p_option_defaults_block"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_option_defaults_block">[docs]</a><span class="k">def</span> <span class="nf">p_option_defaults_block</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;options_block :  OPTION_DEFAULTS_ID LBRACE option_block_stmts RBRACE &quot;&quot;&quot;</span>
</div>
<div class="viewcode-block" id="p_option_defaults_block_stmts"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_option_defaults_block_stmts">[docs]</a><span class="k">def</span> <span class="nf">p_option_defaults_block_stmts</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;option_block_stmts : empty</span>
<span class="sd">                           | option_block_stmts option_block_stmt&quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>
</div>
<div class="viewcode-block" id="p_option_block_block_stmt"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_option_block_block_stmt">[docs]</a><span class="k">def</span> <span class="nf">p_option_block_block_stmt</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;option_block_stmt : MIN_DIAMETER_ID COLON FLOAT SEMICOLON &quot;&quot;&quot;</span>
    <span class="c"># Set the option</span>
    <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">global_options</span><span class="p">[</span><span class="n">MeshGenerationOptions</span><span class="o">.</span><span class="n">minimum_diameter</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>







<span class="c"># COLOR_ALIASES</span>
<span class="c"># =============</span></div>
<div class="viewcode-block" id="p_color_aliases_block"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_aliases_block">[docs]</a><span class="k">def</span> <span class="nf">p_color_aliases_block</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_aliases_block :  COLOR_ALIASES_ID LBRACE color_aliases_block_stmts RBRACE &quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>
</div>
<div class="viewcode-block" id="p_color_aliases_block_stmts"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_aliases_block_stmts">[docs]</a><span class="k">def</span> <span class="nf">p_color_aliases_block_stmts</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_aliases_block_stmts : empty</span>
<span class="sd">                                   | color_aliases_block_stmts color_aliases_block_stmt&quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>
</div>
<div class="viewcode-block" id="p_color_aliases_block_stmt"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_aliases_block_stmt">[docs]</a><span class="k">def</span> <span class="nf">p_color_aliases_block_stmt</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_aliases_block_stmt : ID COLON color_rgb SEMICOLON &quot;&quot;&quot;</span>
    <span class="c"># Register the alias:</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">add_alias</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>



<span class="c"># COLOR_DEFAULTS:</span>
<span class="c"># ================</span></div>
<div class="viewcode-block" id="p_color_defaults_block"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_defaults_block">[docs]</a><span class="k">def</span> <span class="nf">p_color_defaults_block</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_defaults_block :  COLOR_DEFAULTS_ID LBRACE color_defaults_block_stmts RBRACE &quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>
</div>
<div class="viewcode-block" id="p_color_defaults_block_stmts"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_defaults_block_stmts">[docs]</a><span class="k">def</span> <span class="nf">p_color_defaults_block_stmts</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_defaults_block_stmts : empty</span>
<span class="sd">                                   | color_defaults_block_stmts color_defaults_block_stmt&quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>

</div>
<div class="viewcode-block" id="p_color_defaults_block_stmt"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color_defaults_block_stmt">[docs]</a><span class="k">def</span> <span class="nf">p_color_defaults_block_stmt</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_defaults_block_stmt : region_color_def &quot;&quot;&quot;</span>
    <span class="n">rgns</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rgn_id</span> <span class="ow">in</span> <span class="n">rgns</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">set_default_region_color</span><span class="p">(</span><span class="n">rgn_id</span><span class="o">=</span><span class="n">rgn_id</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>






<span class="c"># MAKEPLY Block</span>
<span class="c"># ==============</span>
</div>
<div class="viewcode-block" id="p_ply_block"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;makeply_block :  MAKEPLY_ID FILENAME ply_block_open LBRACE makeply_block_stmts  RBRACE &quot;&quot;&quot;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">close_ply_block</span><span class="p">(</span><span class="n">plyfilename</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="p_ply_block_open"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block_open">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block_open</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;ply_block_open : empty&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">new_ply_block</span><span class="p">()</span>

</div>
<div class="viewcode-block" id="p_ply_block_stmts"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block_stmts">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block_stmts</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;makeply_block_stmts : empty</span>
<span class="sd">                            | makeply_block_stmts makeply_block_stmt</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>
</div>
<div class="viewcode-block" id="p_ply_block_stmt"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block_stmt">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block_stmt</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;makeply_block_stmt : makeply_block_stmt_color</span>
<span class="sd">                          | makeply_block_stmt_include  &quot;&quot;&quot;</span>
    <span class="c"># Don&#39;t need to do anything.</span>

</div>
<div class="viewcode-block" id="p_ply_block_stmt_color"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block_stmt_color">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block_stmt_color</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;makeply_block_stmt_color : region_color_def&quot;&quot;&quot;</span>
    <span class="n">rgns</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">rgn</span> <span class="ow">in</span> <span class="n">rgns</span><span class="p">:</span>
        <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">currentplyscope</span><span class="o">.</span><span class="n">set_region_color</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="n">rgn</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>

</div>
<div class="viewcode-block" id="p_ply_block_stmt_include"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_ply_block_stmt_include">[docs]</a><span class="k">def</span> <span class="nf">p_ply_block_stmt_include</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;makeply_block_stmt_include : INCLUDE_ID  FILENAME include_option_set SEMICOLON&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">currentplyscope</span><span class="o">.</span><span class="n">include_file</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">options</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="p_include_option_set"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_include_option_set">[docs]</a><span class="k">def</span> <span class="nf">p_include_option_set</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;include_option_set : empty</span>
<span class="sd">                          | LBRACE include_options RBRACE&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="p">{}</span>
    <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span>  <span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">assert</span> <span class="bp">False</span>

</div>
<div class="viewcode-block" id="p_include_option_trim"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_include_option_trim">[docs]</a><span class="k">def</span> <span class="nf">p_include_option_trim</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;include_option : TRIM_ID COLON INT&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;trim&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]}</span>

</div>
<div class="viewcode-block" id="p_include_option_offset"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_include_option_offset">[docs]</a><span class="k">def</span> <span class="nf">p_include_option_offset</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;include_option : OFFSET_ID COLON LPAREN INT COMMA INT COMMA INT RPAREN &quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;offset&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">8</span><span class="p">])}</span>

</div>
<div class="viewcode-block" id="p_include_optionsA"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_include_optionsA">[docs]</a><span class="k">def</span> <span class="nf">p_include_optionsA</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;include_options : empty&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

</div>
<div class="viewcode-block" id="p_include_optionsB"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_include_optionsB">[docs]</a><span class="k">def</span> <span class="nf">p_include_optionsB</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;include_options : include_option</span>
<span class="sd">                       | include_options COMMA include_option&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="p_region_color_def_stmt"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_region_color_def_stmt">[docs]</a><span class="k">def</span> <span class="nf">p_region_color_def_stmt</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;region_color_def : REGIONCOLOR_ID int_list COLON color SEMICOLON &quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="p_color"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color">[docs]</a><span class="k">def</span> <span class="nf">p_color</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color : color_rgb</span>
<span class="sd">              | color_alias&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</div>
<div class="viewcode-block" id="p_color3"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color3">[docs]</a><span class="k">def</span> <span class="nf">p_color3</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color : IGNORE_ID &quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">None</span>
</div>
<div class="viewcode-block" id="p_color1"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color1">[docs]</a><span class="k">def</span> <span class="nf">p_color1</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_rgb : LPAREN INT COMMA INT COMMA INT RPAREN&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">ColorDef</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">g</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">4</span><span class="p">],</span> <span class="n">b</span><span class="o">=</span><span class="n">p</span><span class="p">[</span><span class="mi">6</span><span class="p">])</span>
</div>
<div class="viewcode-block" id="p_color2"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_color2">[docs]</a><span class="k">def</span> <span class="nf">p_color2</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;color_alias : ID&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">parser</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">get_color</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

</div>
<div class="viewcode-block" id="p_int_list"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_int_list">[docs]</a><span class="k">def</span> <span class="nf">p_int_list</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;int_list : INT</span>
<span class="sd">                 | int_list COMMA INT &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="n">p</span><span class="p">[</span><span class="mi">3</span><span class="p">]]</span>
</div>
<div class="viewcode-block" id="p_int_list_star"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_int_list_star">[docs]</a><span class="k">def</span> <span class="nf">p_int_list_star</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">r&quot;&quot;&quot;int_list : STAR&quot;&quot;&quot;</span>
    <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="bp">None</span><span class="p">]</span>

</div>
<div class="viewcode-block" id="p_empty"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_empty">[docs]</a><span class="k">def</span> <span class="nf">p_empty</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;empty : &#39;&#39;&#39;</span>

    <span class="k">pass</span>






<span class="c"># Error rule for syntax errors</span>
</div>
<div class="viewcode-block" id="p_error"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.p_error">[docs]</a><span class="k">def</span> <span class="nf">p_error</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
    <span class="k">raise</span> <span class="n">MultiMeshParseError</span><span class="p">(</span><span class="s">&quot;Yacc Error on line: </span><span class="si">%d</span><span class="s"> Token: &#39;</span><span class="si">%s</span><span class="s">&#39;&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">lineno</span><span class="p">,</span> <span class="n">p</span><span class="o">.</span><span class="n">type</span><span class="p">))</span>




</div>
<span class="kn">from</span> <span class="nn">zipfile</span> <span class="kn">import</span> <span class="n">ZipFile</span>


<div class="viewcode-block" id="parse_mesh_config"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.parse_mesh_config">[docs]</a><span class="k">def</span> <span class="nf">parse_mesh_config</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
    <span class="c"># Build the parser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">yacc</span><span class="o">.</span><span class="n">yacc</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">lexer</span><span class="o">=</span><span class="n">lex</span><span class="p">)</span>

    <span class="k">print</span> <span class="s">&#39;Parsed OK&#39;</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">context</span>

</div>
<div class="viewcode-block" id="parse_zip_file"><a class="viewcode-back" href="../../../../apidoc/mfi-core/morphforgecontrib.indev.meshtools.html#morphforgecontrib.indev.meshtools.mesh_config_parser.parse_zip_file">[docs]</a><span class="k">def</span> <span class="nf">parse_zip_file</span><span class="p">(</span><span class="n">zip_in</span><span class="p">,</span> <span class="n">zip_out</span><span class="p">):</span>
    <span class="c"># Build the parser</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">yacc</span><span class="o">.</span><span class="n">yacc</span><span class="p">()</span>

    <span class="n">fIn</span> <span class="o">=</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_in</span><span class="p">,</span> <span class="s">&#39;r&#39;</span><span class="p">)</span>
    <span class="n">fOut</span> <span class="o">=</span> <span class="n">ZipFile</span><span class="p">(</span><span class="n">zip_out</span><span class="p">,</span> <span class="s">&#39;w&#39;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">Context</span><span class="p">(</span><span class="n">src_zip_file</span><span class="o">=</span><span class="n">fIn</span><span class="p">,</span> <span class="n">dst_zip_file</span><span class="o">=</span><span class="n">fOut</span><span class="p">)</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">fIn</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;config.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">conf</span> <span class="o">=</span> <span class="n">fIn</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s">&#39;src/config.txt&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>

    <span class="n">parser</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">conf</span><span class="p">,</span> <span class="n">lexer</span><span class="o">=</span><span class="n">lex</span><span class="p">)</span>

    <span class="n">fIn</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">fOut</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">print</span> <span class="s">&#39;Parsed OK&#39;</span>
    <span class="k">return</span> <span class="n">parser</span><span class="o">.</span><span class="n">context</span>
</pre></div></div>

      </div>
      <div class="bottomnav">
      
        <p>
        <a class="uplink" href="../../../../index.html">Contents</a>
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2012, Mike Hull.
    </div>
  </body>
</html>